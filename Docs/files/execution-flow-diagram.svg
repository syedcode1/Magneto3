<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1200" style="background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);">
  <defs>
    <style>
      .title { font: bold 28px 'Consolas', monospace; fill: #00ff00; }
      .step-title { font: bold 13px 'Consolas', monospace; fill: #ffffff; }
      .step-text { font: 10px 'Consolas', monospace; fill: #cccccc; }
      .phase-label { font: bold 16px 'Consolas', monospace; fill: #00ccff; }
      .arrow { stroke: #00ff00; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .decision-arrow-yes { stroke: #00ff00; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .decision-arrow-no { stroke: #ff0000; stroke-width: 2; fill: none; marker-end: url(#arrowhead-red); }
      .note-text { font: 10px 'Consolas', monospace; fill: #888888; font-style: italic; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#00ff00" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff0000" />
    </marker>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>
  
  <!-- Title -->
  <text x="500" y="35" class="title" text-anchor="middle" filter="url(#glow)">MAGNETO v3 Attack Execution Flow</text>
  <line x1="200" y1="45" x2="800" y2="45" stroke="#00ff00" stroke-width="1"/>
  
  <!-- Phase 1: Initialization -->
  <text x="50" y="75" class="phase-label">Phase 1: Initialization</text>
  
  <!-- Start -->
  <ellipse cx="500" cy="100" rx="80" ry="30" fill="#1a5c1a" stroke="#00ff00" stroke-width="2"/>
  <text x="500" y="95" class="step-title" text-anchor="middle">USER START</text>
  <text x="500" y="110" class="step-text" text-anchor="middle">GUI or CLI</text>
  
  <!-- Arrow -->
  <path class="arrow" d="M 500 130 L 500 165"/>
  
  <!-- Configuration -->
  <rect x="400" y="165" width="200" height="60" fill="#1a1a1a" stroke="#00ff00" stroke-width="2" rx="5"/>
  <text x="500" y="185" class="step-title" text-anchor="middle">Load Configuration</text>
  <text x="500" y="200" class="step-text" text-anchor="middle">• Parse parameters</text>
  <text x="500" y="213" class="step-text" text-anchor="middle">• Load technique library</text>
  
  <path class="arrow" d="M 500 225 L 500 260"/>
  
  <!-- Phase 2: Selection -->
  <text x="50" y="280" class="phase-label">Phase 2: Technique Selection</text>
  
  <!-- Selection Logic -->
  <polygon points="500,265 600,305 500,345 400,305" fill="#1a1a1a" stroke="#ffcc00" stroke-width="2"/>
  <text x="500" y="300" class="step-title" text-anchor="middle">Selection</text>
  <text x="500" y="315" class="step-text" text-anchor="middle">Mode?</text>
  
  <!-- APT Campaign Branch -->
  <path class="decision-arrow-yes" d="M 400 305 L 250 305"/>
  <rect x="150" y="280" width="100" height="50" fill="#1a1a1a" stroke="#ff0000" stroke-width="2" rx="3"/>
  <text x="200" y="298" class="step-text" text-anchor="middle">APT</text>
  <text x="200" y="311" class="step-text" text-anchor="middle">Campaign</text>
  <text x="200" y="324" class="step-text" text-anchor="middle">Chain</text>
  
  <!-- Industry Vertical Branch -->
  <path class="decision-arrow-yes" d="M 500 345 L 500 380"/>
  <rect x="450" y="380" width="100" height="50" fill="#1a1a1a" stroke="#ff0000" stroke-width="2" rx="3"/>
  <text x="500" y="398" class="step-text" text-anchor="middle">Industry</text>
  <text x="500" y="411" class="step-text" text-anchor="middle">Vertical</text>
  <text x="500" y="424" class="step-text" text-anchor="middle">Scenario</text>
  
  <!-- Random Branch -->
  <path class="decision-arrow-yes" d="M 600 305 L 750 305"/>
  <rect x="750" y="280" width="100" height="50" fill="#1a1a1a" stroke="#ff0000" stroke-width="2" rx="3"/>
  <text x="800" y="298" class="step-text" text-anchor="middle">Random</text>
  <text x="800" y="311" class="step-text" text-anchor="middle">with</text>
  <text x="800" y="324" class="step-text" text-anchor="middle">Filters</text>
  
  <!-- Converge to Selected Techniques -->
  <path class="arrow" d="M 200 330 L 200 450 L 400 450"/>
  <path class="arrow" d="M 500 430 L 500 450"/>
  <path class="arrow" d="M 800 330 L 800 450 L 600 450"/>
  
  <rect x="400" y="450" width="200" height="50" fill="#1a5c1a" stroke="#00ff00" stroke-width="2" rx="5"/>
  <text x="500" y="468" class="step-title" text-anchor="middle">Selected Techniques</text>
  <text x="500" y="485" class="step-text" text-anchor="middle">Filtered & Ordered Array</text>
  
  <path class="arrow" d="M 500 500 L 500 535"/>
  
  <!-- Phase 3: Execution Loop -->
  <text x="50" y="555" class="phase-label">Phase 3: Execution Loop</text>
  
  <!-- For Each Loop Start -->
  <rect x="380" y="535" width="240" height="40" fill="#1a1a1a" stroke="#00ccff" stroke-width="2" rx="5"/>
  <text x="500" y="555" class="step-title" text-anchor="middle">FOR EACH Technique</text>
  <text x="500" y="568" class="step-text" text-anchor="middle">(Iterate through selected array)</text>
  
  <path class="arrow" d="M 500 575 L 500 610"/>
  
  <!-- Validation Decision -->
  <polygon points="500,615 580,655 500,695 420,655" fill="#1a1a1a" stroke="#ffcc00" stroke-width="2"/>
  <text x="500" y="650" class="step-title" text-anchor="middle">Validation</text>
  <text x="500" y="665" class="step-text" text-anchor="middle">Required?</text>
  
  <!-- No Validation Path -->
  <path class="decision-arrow-no" d="M 580 655 L 700 655"/>
  <text x="640" y="650" class="note-text">No</text>
  
  <!-- Yes Validation Path -->
  <path class="decision-arrow-yes" d="M 500 695 L 500 730"/>
  <text x="515" y="715" class="note-text">Yes</text>
  
  <!-- Validation Checks -->
  <rect x="400" y="730" width="200" height="70" fill="#1a1a1a" stroke="#ffcc00" stroke-width="2" rx="5"/>
  <text x="500" y="748" class="step-title" text-anchor="middle">Validation Checks</text>
  <text x="500" y="763" class="step-text" text-anchor="middle">• Admin privileges?</text>
  <text x="500" y="776" class="step-text" text-anchor="middle">• Domain joined?</text>
  <text x="500" y="789" class="step-text" text-anchor="middle">• Custom requirements?</text>
  
  <path class="arrow" d="M 500 800 L 500 835"/>
  
  <!-- Pass/Fail Decision -->
  <polygon points="500,840 580,880 500,920 420,880" fill="#1a1a1a" stroke="#ffcc00" stroke-width="2"/>
  <text x="500" y="875" class="step-title" text-anchor="middle">Pass</text>
  <text x="500" y="890" class="step-text" text-anchor="middle">Check?</text>
  
  <!-- Fail Path - Skip -->
  <path class="decision-arrow-no" d="M 420 880 L 250 880"/>
  <text x="340" y="875" class="note-text">Fail</text>
  <rect x="150" y="855" width="100" height="50" fill="#5c1a1a" stroke="#ff0000" stroke-width="2" rx="3"/>
  <text x="200" y="873" class="step-text" text-anchor="middle" fill="#ff6666">SKIP</text>
  <text x="200" y="886" class="step-text" text-anchor="middle">Log reason</text>
  <text x="200" y="899" class="step-text" text-anchor="middle">Continue</text>
  
  <!-- Pass Path - Execute -->
  <path class="decision-arrow-yes" d="M 580 880 L 700 880"/>
  <text x="640" y="875" class="note-text">Pass</text>
  
  <!-- Merge paths to execution -->
  <path class="arrow" d="M 700 655 L 750 655 L 750 880"/>
  <path class="arrow" d="M 700 880 L 750 880"/>
  
  <rect x="700" y="855" width="100" height="50" fill="#1a1a5c" stroke="#00ccff" stroke-width="3" rx="5" filter="url(#glow)"/>
  <text x="750" y="873" class="step-title" text-anchor="middle">EXECUTE</text>
  <text x="750" y="886" class="step-text" text-anchor="middle">LOLBin</text>
  <text x="750" y="899" class="step-text" text-anchor="middle">Command</text>
  
  <!-- Execution paths -->
  <path class="arrow" d="M 750 905 L 750 940"/>
  <path class="arrow" d="M 200 905 L 200 980 L 650 980"/>
  
  <!-- Result Recording -->
  <rect x="650" y="940" width="200" height="60" fill="#1a1a1a" stroke="#9b59b6" stroke-width="2" rx="5"/>
  <text x="750" y="960" class="step-title" text-anchor="middle">Record Result</text>
  <text x="750" y="975" class="step-text" text-anchor="middle">• Success/Fail/Skip status</text>
  <text x="750" y="988" class="step-text" text-anchor="middle">• Generate log entries</text>
  
  <path class="arrow" d="M 750 1000 L 750 1035"/>
  
  <!-- More Techniques Decision -->
  <polygon points="750,1040 820,1075 750,1110 680,1075" fill="#1a1a1a" stroke="#ffcc00" stroke-width="2"/>
  <text x="750" y="1070" class="step-title" text-anchor="middle">More</text>
  <text x="750" y="1085" class="step-text" text-anchor="middle">TTPs?</text>
  
  <!-- Yes - Loop back -->
  <path class="decision-arrow-yes" d="M 680 1075 L 350 1075 L 350 555 L 380 555"/>
  <text x="520" y="1070" class="note-text">Yes (Delay 2s)</text>
  
  <!-- No - Continue to Phase 4 -->
  <path class="arrow" d="M 750 1110 L 750 1155"/>
  <text x="765" y="1133" class="note-text">No</text>
  
  <!-- Phase 4: Completion -->
  <text x="50" y="1175" class="phase-label">Phase 4: Completion</text>
  
  <!-- Summary & Reports -->
  <rect x="650" y="1155" width="200" height="40" fill="#1a1a1a" stroke="#00ff00" stroke-width="2" rx="5"/>
  <text x="750" y="1173" class="step-title" text-anchor="middle">Generate Summary</text>
  <text x="750" y="1188" class="step-text" text-anchor="middle">Success/Fail/Skip counts</text>
  
  <!-- Final outputs -->
  <rect x="150" y="1155" width="120" height="35" fill="#1a1a1a" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="210" y="1173" class="step-text" text-anchor="middle">TXT Log</text>
  <text x="210" y="1185" class="step-text" text-anchor="middle">Attack Logs/</text>
  
  <rect x="300" y="1155" width="120" height="35" fill="#1a1a1a" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="360" y="1173" class="step-text" text-anchor="middle">HTML Report</text>
  <text x="360" y="1185" class="step-text" text-anchor="middle">Reports/</text>
  
  <rect x="450" y="1155" width="120" height="35" fill="#1a1a1a" stroke="#9b59b6" stroke-width="1" rx="3"/>
  <text x="510" y="1173" class="step-text" text-anchor="middle">SIEM Events</text>
  <text x="510" y="1185" class="step-text" text-anchor="middle">Event Logs</text>
  
  <!-- Arrows to outputs -->
  <path class="arrow" d="M 750 1155 L 750 1130 L 210 1130 L 210 1155"/>
  <path class="arrow" d="M 750 1155 L 750 1130 L 360 1130 L 360 1155"/>
  <path class="arrow" d="M 750 1155 L 750 1130 L 510 1130 L 510 1155"/>
  
  <!-- Completion -->
  <ellipse cx="500" cy="1170" rx="80" ry="25" fill="#1a5c1a" stroke="#00ff00" stroke-width="2"/>
  <text x="500" y="1173" class="step-title" text-anchor="middle">COMPLETE</text>
  
  <!-- Legend -->
  <rect x="20" y="20" width="150" height="130" fill="#0f0f0f" stroke="#00ff00" stroke-width="1" rx="3"/>
  <text x="95" y="38" class="step-text" text-anchor="middle" font-weight="bold">LEGEND</text>
  <ellipse cx="40" cy="57" rx="15" ry="8" fill="#1a5c1a" stroke="#00ff00" stroke-width="1"/>
  <text x="65" y="60" class="step-text">Start/End</text>
  <rect x="25" y="70" width="30" height="15" fill="#1a1a1a" stroke="#00ff00" stroke-width="1" rx="2"/>
  <text x="65" y="80" class="step-text">Process</text>
  <polygon points="40,95 50,102 40,109 30,102" fill="#1a1a1a" stroke="#ffcc00" stroke-width="1"/>
  <text x="65" y="103" class="step-text">Decision</text>
  <rect x="25" y="115" width="30" height="15" fill="#1a1a5c" stroke="#00ccff" stroke-width="2" rx="2"/>
  <text x="65" y="125" class="step-text">Execution</text>
  <rect x="25" y="135" width="30" height="15" fill="#5c1a1a" stroke="#ff0000" stroke-width="1" rx="2"/>
  <text x="65" y="145" class="step-text">Skip/Error</text>
  
  <!-- Notes -->
  <text x="500" y="1195" class="note-text" text-anchor="middle">* All techniques use native Windows binaries (LOLBins) - No malware</text>
</svg>
